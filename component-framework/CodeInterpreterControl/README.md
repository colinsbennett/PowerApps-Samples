---
languages:
  - typescript
products:
  - power-platform
  - power-apps
  - dynamics-365
page_type: sample
description: "This sample demonstrates a Power Apps Component Framework (PCF) control that integrates with Code Interpreter enabled prompts. It can display interactive data visuals in HTML and Javascript or create file previews and downloads for PDF, Word, PowerPoint and Excel documents."
---

## Features

- **Code Interpreter Integration**: Seamlessly integrates with Code Interpreter enabled prompts that generate Word, PowerPoint, Excel, or PDF documents or interactive data visuals in HTML and Javascript.
- **File Preview**: Native preview support for PDF, Word (.docx), and Excel (.xlsx) documents
- **Download Support**: Direct download links for all supported file types

## Compatibility

This sample works for model-driven apps in Dynamics 365 environments with AI capabilities re: Code Intepreter enabled.

## Applies to

[Power Apps component framework](https://learn.microsoft.com/power-apps/developer/component-framework/overview)

Get your own free development tenant by subscribing to [Power Apps Developer Plan](https://learn.microsoft.com/power-platform/developer/plan).

## Version history

| Version | Date             | Comments                                               |
| ------- | ---------------- | ----------------------------------------------------- |
| 1.0     | July 28, 2025    | Initial release with PDF, Word, and Excel preview   |

## Prerequisites

- [Install the Microsoft Power Platform CLI](https://learn.microsoft.com/power-platform/developer/cli/introduction)
- Node.js and npm installed
- Dynamics 365 environment with AI Builder capabilities
- A Code Interpreter enable prompt with a single input named 'RecordId' in your environment. [Review Code Interpreter documentation here](https://learn.microsoft.com/en-us/microsoft-365-copilot/extensibility/code-interpreter)

## Dependencies

This project uses the following npm packages:

```json
{
  "mammoth": "^1.9.1",
  "xlsx": "^0.18.5"
}
```

## Configuration

### Control Properties

- **Model ID**: GUID of the Code Interpreter enabled AI model
- **Entity ID**: GUID of the current record to process. Bind this to the unique identifier of your table e.g. Account (Text)

## Try this sample

Follow the steps in the [README.md](../README.md) to generate solutions containing the controls so you can import and try the sample components in your model-driven or canvas app.

Alternatively for this sample in standalone,
1. Clone the respository and navigate to the CodeInterpreterControl directory:
   ```bash
   git clone https://github.com/microsoft/PowerApps-Samples
   cd PowerApps-Samples\component-framework\CodeInterpreterControl
   ```

2. Install dependencies:
   ```bash
   npm install
   ```

3. Build the project:
   ```bash
   npm run build
   ```

4. Test locally:
   ```bash
   npm start
   ```

5. Deploy to your Dynamics 365 environment:
   ```bash
   pac pcf push --publisher-prefix <your-prefix>
   ```

### Try these Code Interpreter prompts with this sample

- **Account Interactive Row Summary Chart**: "For the columns 'Account.Account' 'Account.Account Name' 'Account.Account Number' 'Account.Address 1: Street 1' 'Account.Category' 'Account.Credit Limit' create an interactive chart that compares the record with ID 'RecordId' against other records. Return a mimetype of text/html"
- **Account Sales Proposal Document Preview + Download**: "Using the columns 'Account.Account' 'Account.Account Name' 'Account.Account Number' 'Account.Address 1: Street 1' 'Account.Category' 'Account.Credit Limit' create a sales proposal document as a PDF for the record with id 'RecordId'" 

## Configuration in Dynamics 365

1. Import the solution containing the PCF control (see 'Try this sample' above)
2. Add the control to a Dataverse form in a model-driven app
3. Configure the Model ID property with your prompt's [AI Model GUID](https://learn.microsoft.com/en-us/power-apps/developer/data-platform/reference/entities/msdyn_aimodel#BKMK_msdyn_AIModelId)
4. Configure the Record ID property to pass the current record ID by binding it to the column representing the unique identifier of the table e.g. Account (Text)
5. Ensure your prompt has Code Interpreter capabilities enabled.
6. Optionally [add synthetic data generated by Code Interpreter](https://learn.microsoft.com/en-us/microsoft-365-copilot/extensibility/code-interpreter#create-synthetic-data) e.g. "Create sample data in the Account table using the 'Account.Account' 'Account.Account Name' 'Account.Account Number' 'Account.Address 1: Street 1' 'Account.Category' 'Account.Credit Limit' columns"

## Related information

- [Power Apps Component Framework](https://learn.microsoft.com/power-apps/developer/component-framework/overview)

## Disclaimer

**THIS CODE IS PROVIDED _AS IS_ WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESS OR IMPLIED, INCLUDING ANY IMPLIED WARRANTIES OF FITNESS FOR A PARTICULAR PURPOSE, MERCHANTABILITY, OR NON-INFRINGEMENT.**